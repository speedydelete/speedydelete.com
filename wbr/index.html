<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>What Beats Rock Database</title>
        <style>

* {
    font-family: 'Courier New', Courier, monospace;
    font-size: 18px;
    box-sizing: border-box;
}

input {
    overflow-x: scroll;
    border: 1px solid lightgrey;
    padding: 10px;
    width: 40ch;
}

button {
    padding: 5px;
    background-color: lightgrey;
    border-radius: 5px;
}

body {
    display: flex;
    flex-direction: column;
    padding: 5%;
    height: 100vh;
    overflow: hidden;
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
}

main {
    flex-grow: 1;
    width: 100%;
    display: flex;
    flex-direction: row;
    justify-content: flex-start;
}

#add {
    width: 50%;
    padding-right: 20px;
}

select, option {
    padding: 5px;
    appearance: none;
}

#chain-tab, #trophy-tab {
    display: none;
}

textarea {
    width: 40ch;
    height: 20ch;
    overflow: scroll;
    word-wrap: break-word;
}

#get {
    width: 50%;
}

#ttb {
    display: none;
}

#status {
    position: absolute;
    bottom: 0;
    left: 0;
    padding: 20px;
}

ul {
    overflow-y: scroll;
    max-width: 600px;
    height: 300px;
    margin-bottom: 20px;
}

@media (width < 1200px) {
    ul {
        max-width: 500px;
    }
    textarea, input {
        width: 30ch;
    }
}

@media (width < 1000px) {
    ul {
        max-width: 400px;
    }
    textarea, input {
        width: 25ch;
    }
}

@media (width < 800px) {
    ul {
        max-width: 300px;
    }
    textarea, input {
        width: 20ch;
    }
}

@media (width < 600px) {
    ul {
        max-width: 200px;
    }
    textarea, input {
        width: 15ch;
    }
}

        </style>
    </head>
    <body>
        <main>
            <div id="add">
                add combination:<br><br>
                input method: 
                <select class="font-fix" id="mode" onchange="switchTab();">
                    <option value="individual" selected="selected">Individual</option>
                    <option value="chain">Chain</option>
                    <option value="trophy">Trophy list</option>
                </select><br><br>
                <div id="individual-tab">
                    <input id="beats" type="text" width="40" placeholder="paper"><br><br>
                    beats<br><br>
                    <input id="beaten" type="text" width="40" placeholder="rock">
                </div>
                <div id="chain-tab">
                    Paste in chain:<br><br>
                    <textarea id="chain" placeholder="nothing üòµ paper ü§ú rock"></textarea>
                </div>
                <div id="trophy-tab">
                    Paste in your trophy list:<br><br>
                    <textarea id="trophy" placeholder="rock ü™® with dimension collapser üåÄ&#10;&#10;babel fish üêü with ford prefect üöó"></textarea>
                </div>
                <br><br>
                <button id="add-send" onclick="addCombination();">Send</button>
            </div>
            <div id="get">
                what beats...<br><br>
                <input id="query" type="text" width="40" placeholder="rock"><br><br>
                <button id="get-send" onclick="getBeats();">Query</button>
                <br><br>
                <div id="ttb">found <span id="out-count"></span> things that beat <span id="out-query"></span>:</div>
                <ul id="results"></ul>
            </div>
            <div id="status">
                <span id="time"></span>
                <span id="status-code"></span>
                <span id="reason"></span>
            </div>
        </main>
        <script>

const EMOJI = [
    "üòÄ", "üòÅ", "üòÇ", "ü§£", "üòÉ", "üòÑ", "üòÖ", "üòÜ", "üòâ", "üòä", "üòã", "üòé", "üòç", "üòò", "üòó", "üòô", "üòö", "‚ò∫", "üôÇ", "ü§ó", "ü§î", 
    "üòê", "üòë", "üò∂", "üôÑ", "üòè", "üò£", "üò•", "üòÆ", "ü§ê", "üòØ", "üò™", "üò´", "üò¥", "üòå", "ü§ì", "üòõ", "üòú", "üòù", "ü§§", "üòí", "üòì", 
    "üòî", "üòï", "üôÉ", "ü§ë", "üò≤", "‚òπ", "üôÅ", "üòñ", "üòû", "üòü", "üò§", "üò¢", "üò≠", "üò¶", "üòß", "üò®", "üò©", "üò¨", "üò∞", "üò±", "üò≥", 
    "üòµ", "üò°", "üò†", "üòá", "ü§†", "ü§°", "ü§•", "üò∑", "ü§í", "ü§ï", "ü§¢", "ü§ß", "üòà", "üëø", "üëπ", "üë∫", "üíÄ", "‚ò†", "üëª", "üëΩ", "üëæ", 
    "ü§ñ", "üí©", "üò∫", "üò∏", "üòπ", "üòª", "üòº", "üòΩ", "üôÄ", "üòø", "üòæ", "üôà", "üôâ", "üôä", "üë¶", "üë¶üèª", "üë¶üèº", "üë¶üèΩ", "üë¶üèæ", "üë¶üèø", "üëß", 
    "üëßüèª", "üëßüèº", "üëßüèΩ", "üëßüèæ", "üëßüèø", "üë®", "üë®üèª", "üë®üèº", "üë®üèΩ", "üë®üèæ", "üë®üèø", "üë©", "üë©üèª", "üë©üèº", "üë©üèΩ", "üë©üèæ", "üë©üèø", "üë¥", "üë¥üèª", "üë¥üèº", "üë¥üèΩ", 
    "üë¥üèæ", "üë¥üèø", "üëµ", "üëµüèª", "üëµüèº", "üëµüèΩ", "üëµüèæ", "üëµüèø", "üë∂", "üë∂üèª", "üë∂üèº", "üë∂üèΩ", "üë∂üèæ", "üë∂üèø", "üëº", "üëºüèª", "üëºüèº", "üëºüèΩ", "üëºüèæ", "üëºüèø", "üëÆ", 
    "üëÆüèª", "üëÆüèº", "üëÆüèΩ", "üëÆüèæ", "üëÆüèø", "üïµ", "üïµüèª", "üïµüèº", "üïµüèΩ", "üïµüèæ", "üïµüèø", "üíÇ", "üíÇüèª", "üíÇüèº", "üíÇüèΩ", "üíÇüèæ", "üíÇüèø", "üë∑", "üë∑üèª", "üë∑üèº", "üë∑üèΩ", 
    "üë∑üèæ", "üë∑üèø", "üë≥", "üë≥üèª", "üë≥üèº", "üë≥üèΩ", "üë≥üèæ", "üë≥üèø", "üë±", "üë±üèª", "üë±üèº", "üë±üèΩ", "üë±üèæ", "üë±üèø", "üéÖ", "üéÖüèª", "üéÖüèº", "üéÖüèΩ", "üéÖüèæ", "üéÖüèø", "ü§∂", 
    "ü§∂üèª", "ü§∂üèº", "ü§∂üèΩ", "ü§∂üèæ", "ü§∂üèø", "üë∏", "üë∏üèª", "üë∏üèº", "üë∏üèΩ", "üë∏üèæ", "üë∏üèø", "ü§¥", "ü§¥üèª", "ü§¥üèº", "ü§¥üèΩ", "ü§¥üèæ", "ü§¥üèø", "üë∞", "üë∞üèª", "üë∞üèº", "üë∞üèΩ", 
    "üë∞üèæ", "üë∞üèø", "ü§µ", "ü§µüèª", "ü§µüèº", "ü§µüèΩ", "ü§µüèæ", "ü§µüèø", "ü§∞", "ü§∞üèª", "ü§∞üèº", "ü§∞üèΩ", "ü§∞üèæ", "ü§∞üèø", "üë≤", "üë≤üèª", "üë≤üèº", "üë≤üèΩ", "üë≤üèæ", "üë≤üèø", "üôç", 
    "üôçüèª", "üôçüèº", "üôçüèΩ", "üôçüèæ", "üôçüèø", "üôé", "üôéüèª", "üôéüèº", "üôéüèΩ", "üôéüèæ", "üôéüèø", "üôÖ", "üôÖüèª", "üôÖüèº", "üôÖüèΩ", "üôÖüèæ", "üôÖüèø", "üôÜ", "üôÜüèª", "üôÜüèº", "üôÜüèΩ", 
    "üôÜüèæ", "üôÜüèø", "üíÅ", "üíÅüèª", "üíÅüèº", "üíÅüèΩ", "üíÅüèæ", "üíÅüèø", "üôã", "üôãüèª", "üôãüèº", "üôãüèΩ", "üôãüèæ", "üôãüèø", "üôá", "üôáüèª", "üôáüèº", "üôáüèΩ", "üôáüèæ", "üôáüèø", "ü§¶", 
    "ü§¶üèª", "ü§¶üèº", "ü§¶üèΩ", "ü§¶üèæ", "ü§¶üèø", "ü§∑", "ü§∑üèª", "ü§∑üèº", "ü§∑üèΩ", "ü§∑üèæ", "ü§∑üèø", "üíÜ", "üíÜüèª", "üíÜüèº", "üíÜüèΩ", "üíÜüèæ", "üíÜüèø", "üíá", "üíáüèª", "üíáüèº", "üíáüèΩ", 
    "üíáüèæ", "üíáüèø", "üö∂", "üö∂üèª", "üö∂üèº", "üö∂üèΩ", "üö∂üèæ", "üö∂üèø", "üèÉ", "üèÉüèª", "üèÉüèº", "üèÉüèΩ", "üèÉüèæ", "üèÉüèø", "üíÉ", "üíÉüèª", "üíÉüèº", "üíÉüèΩ", "üíÉüèæ", "üíÉüèø", "üï∫", 
    "üï∫üèª", "üï∫üèº", "üï∫üèΩ", "üï∫üèæ", "üï∫üèø", "üëØ", "üï¥", "üó£", "üë§", "üë•", "ü§∫", "üèá", "‚õ∑", "üèÇ", "üèå", "üèÑ", "üèÑüèª", "üèÑüèº", "üèÑüèΩ", "üèÑüèæ", "üèÑüèø", 
    "üö£", "üö£üèª", "üö£üèº", "üö£üèΩ", "üö£üèæ", "üö£üèø", "üèä", "üèäüèª", "üèäüèº", "üèäüèΩ", "üèäüèæ", "üèäüèø", "‚õπ", "‚õπüèª", "‚õπüèº", "‚õπüèΩ", "‚õπüèæ", "‚õπüèø", "üèã", "üèãüèª", "üèãüèº", 
    "üèãüèΩ", "üèãüèæ", "üèãüèø", "üö¥", "üö¥üèª", "üö¥üèº", "üö¥üèΩ", "üö¥üèæ", "üö¥üèø", "üöµ", "üöµüèª", "üöµüèº", "üöµüèΩ", "üöµüèæ", "üöµüèø", "üèé", "üèç", "ü§∏", "ü§∏üèª", "ü§∏üèº", "ü§∏üèΩ", 
    "ü§∏üèæ", "ü§∏üèø", "ü§º", "ü§ºüèª", "ü§ºüèº", "ü§ºüèΩ", "ü§ºüèæ", "ü§ºüèø", "ü§Ω", "ü§Ωüèª", "ü§Ωüèº", "ü§ΩüèΩ", "ü§Ωüèæ", "ü§Ωüèø", "ü§æ", "ü§æüèª", "ü§æüèº", "ü§æüèΩ", "ü§æüèæ", 
    "ü§æüèø", "ü§π", "ü§πüèª", "ü§πüèº", "ü§πüèΩ", "ü§πüèæ", "ü§πüèø", "üë´", "üë¨", "üë≠", "üíè", "üë©‚Äç‚ù§Ô∏è‚Äçüíã‚Äçüë®", "üë®‚Äç‚ù§Ô∏è‚Äçüíã‚Äçüë®", "üë©‚Äç‚ù§Ô∏è‚Äçüíã‚Äçüë©", "üíë", "üë©‚Äç‚ù§Ô∏è‚Äçüë®", "üë®‚Äç‚ù§Ô∏è‚Äçüë®", "üë©‚Äç‚ù§Ô∏è‚Äçüë©", 
    "üë™", "üë®‚Äçüë©‚Äçüë¶", "üë®‚Äçüë©‚Äçüëß", "üë®‚Äçüë©‚Äçüëß‚Äçüë¶", "üë®‚Äçüë©‚Äçüë¶‚Äçüë¶", "üë®‚Äçüë©‚Äçüëß‚Äçüëß", "üë®‚Äçüë®‚Äçüë¶", "üë®‚Äçüë®‚Äçüëß", "üë®‚Äçüë®‚Äçüëß‚Äçüë¶", "üë®‚Äçüë®‚Äçüë¶‚Äçüë¶", "üë®‚Äçüë®‚Äçüëß‚Äçüëß", "üë©‚Äçüë©‚Äçüë¶","üë©‚Äçüë©‚Äçüëß", "üë©‚Äçüë©‚Äçüëß‚Äçüë¶", "üë©‚Äçüë©‚Äçüë¶‚Äçüë¶", "üë©‚Äçüë©‚Äçüëß‚Äçüëß", "üèª", "üèº", "üèΩ", "üèæ", "üèø", "üí™", "üí™üèª", "üí™üèº", "üí™üèΩ", "üí™üèæ", "üí™üèø", "ü§≥", "ü§≥üèª", "ü§≥üèº", "ü§≥üèΩ", 
    "ü§≥üèæ", "ü§≥üèø", "üëà", "üëàüèª", "üëàüèº", "üëàüèΩ", "üëàüèæ", "üëàüèø", "üëâ", "üëâüèª", "üëâüèº", "üëâüèΩ", "üëâüèæ", "üëâüèø", "‚òù", "‚òùüèª", "‚òùüèº", "‚òùüèΩ", "‚òùüèæ", "‚òùüèø", "üëÜ", "üëÜüèª", 
    "üëÜüèº", "üëÜüèΩ", "üëÜüèæ", "üëÜüèø", "üñï", "üñïüèª", "üñïüèº", "üñïüèΩ", "üñïüèæ", "üñïüèø", "üëá", "üëáüèª", "üëáüèº", "üëáüèΩ", "üëáüèæ", "üëáüèø", "‚úå", "‚úåüèª", "‚úåüèº", "‚úåüèΩ", "‚úåüèæ", "‚úåüèø", 
    "ü§û", "ü§ûüèª", "ü§ûüèº", "ü§ûüèΩ", "ü§ûüèæ", "ü§ûüèø", "üññ", "üññüèª", "üññüèº", "üññüèΩ", "üññüèæ", "üññüèø", "ü§ò", "ü§òüèª", "ü§òüèº", "ü§òüèΩ", "ü§òüèæ", "ü§òüèø", "ü§ô", "ü§ôüèª", "ü§ôüèº", 
    "ü§ôüèΩ", "ü§ôüèæ", "ü§ôüèø", "üñê", "üñêüèª", "üñêüèº", "üñêüèΩ", "üñêüèæ", "üñêüèø", "‚úã", "‚úãüèª", "‚úãüèº", "‚úãüèΩ", "‚úãüèæ", "‚úãüèø", "üëå", "üëåüèª", "üëåüèº", "üëåüèΩ", "üëåüèæ", "üëåüèø", "üëç", 
    "üëçüèª", 
    "üëçüèº", "üëçüèΩ", "üëçüèæ", "üëçüèø", "üëé", "üëéüèª", "üëéüèº", "üëéüèΩ", "üëéüèæ", "üëéüèø", "‚úä", "‚úäüèª", "‚úäüèº", "‚úäüèΩ", "‚úäüèæ", "‚úäüèø", "üëä", "üëäüèª", "üëäüèº", "üëäüèΩ", "üëäüèæ", "üëäüèø", 
    "ü§õ", "ü§õüèª", "ü§õüèº", "ü§õüèΩ", "ü§õüèæ", "ü§õüèø", "ü§ú", "ü§úüèª", "ü§úüèº", "ü§úüèΩ", "ü§úüèæ", "ü§úüèø", "ü§ö", "ü§öüèª", "ü§öüèº", "ü§öüèΩ", "ü§öüèæ", "ü§öüèø", "üëã", "üëãüèª", "üëãüèº", 
    "üëãüèΩ", "üëãüèæ", "üëãüèø", "üëè", "üëèüèª", "üëèüèº", "üëèüèΩ", "üëèüèæ", "üëèüèø", "‚úç", "‚úçüèª", "‚úçüèº", "‚úçüèΩ", "‚úçüèæ", "‚úçüèø", "üëê", "üëêüèª", "üëêüèº", "üëêüèΩ", "üëêüèæ", "üëêüèø", "üôå", 
    "üôåüèª", "üôåüèº", "üôåüèΩ", "üôåüèæ", "üôåüèø", "üôè", "üôèüèª", "üôèüèº", "üôèüèΩ", "üôèüèæ", "üôèüèø", "ü§ù", "ü§ùüèª", "ü§ùüèº", "ü§ùüèΩ", "ü§ùüèæ", "ü§ùüèø", "üíÖ", "üíÖüèª", "üíÖüèº", "üíÖüèΩ", 
    "üíÖüèæ", "üíÖüèø", "üëÇ", "üëÇüèª", "üëÇüèº", "üëÇüèΩ", "üëÇüèæ", "üëÇüèø", "üëÉ", "üëÉüèª", "üëÉüèº", "üëÉüèΩ", "üëÉüèæ", "üëÉüèø", "üë£", "üëÄ", "üëÅ", "üëÅ‚Äçüó®", "üëÖ", "üëÑ", "üíã", "üíò", "‚ù§", 
    "üíì", "üíî", "üíï", "üíñ", "üíó", "üíô", "üíö", "üíõ", "üíú", "üñ§", "üíù", "üíû", "üíü", "‚ù£", "üíå", "üí§", "üí¢", "üí£", "üí•", "üí¶", "üí®", "üí´", "üí¨", "üó®", "üóØ", "üí≠", "üï≥", 
    "üëì", "üï∂", "üëî", "üëï", "üëñ", "üëó", "üëò", "üëô", "üëö", "üëõ", "üëú", "üëù", "üõç", "üéí", "üëû", "üëü", "üë†", "üë°", "üë¢", "üëë", "üëí", "üé©", "üéì", "‚õë", "üìø", "üíÑ", "üíç", 
    "üíé", "üêµ", "üêí", "ü¶ç", "üê∂", "üêï", "üê©", "üê∫", "ü¶ä", "üê±", "üêà", "ü¶Å", "üêØ", "üêÖ", "üêÜ", "üê¥", "üêé", "ü¶å", "ü¶Ñ", "üêÆ", "üêÇ", "üêÉ", "üêÑ", "üê∑", "üêñ", "üêó", "üêΩ", 
    "üêè", "üêë", "üêê", "üê™", "üê´", "üêò", "ü¶è", "üê≠", "üêÅ", "üêÄ", "üêπ", "üê∞", "üêá", "üêø", "ü¶á", "üêª", "üê®", "üêº", "üêæ", "ü¶É", "üêî", "üêì", "üê£", "üê§", "üê•", "üê¶", "üêß", 
    "üïä", "ü¶Ö", "ü¶Ü", "ü¶â", "üê∏", "üêä", "üê¢", "ü¶é", "üêç", "üê≤", "üêâ", "üê≥", "üêã", "üê¨", "üêü", "üê†", "üê°", "ü¶à", "üêô", "üêö", "ü¶Ä", "ü¶ê", "ü¶ë", "ü¶ã", "üêå", "üêõ", "üêú", 
    "üêù", "üêû", "üï∑", "üï∏", "ü¶Ç", "üíê", "üå∏", "üíÆ", "üèµ", "üåπ", "ü•Ä", "üå∫", "üåª", "üåº", "üå∑", "üå±", "üå≤", "üå≥", "üå¥", "üåµ", "üåæ", "üåø", "‚òò", "üçÄ", "üçÅ", "üçÇ", "üçÉ", 
    "üçá", "üçà", "üçâ", "üçä", "üçã", "üçå", "üçç", "üçé", "üçè", "üçê", "üçë", "üçí", "üçì", "ü•ù", "üçÖ", "ü•ë", "üçÜ", "ü•î", "ü•ï", "üåΩ", "üå∂", "ü•í", "üçÑ", "ü•ú", "üå∞", "üçû", "ü•ê", 
    "ü•ñ", "ü•û", "üßÄ", "üçñ", "üçó", "ü•ì", "üçî", "üçü", "üçï", "üå≠", "üåÆ", "üåØ", "ü•ô", "ü•ö", "üç≥", "ü•ò", "üç≤", "ü•ó", "üçø", "üç±", "üçò", "üçô", "üçö", "üçõ", "üçú", "üçù", "üç†", 
    "üç¢", "üç£", "üç§", "üç•", "üç°", "üç¶", "üçß", "üç®", "üç©", "üç™", "üéÇ", "üç∞", "üç´", "üç¨", "üç≠", "üçÆ", "üçØ", "üçº", "ü•õ", "‚òï", "üçµ", "üç∂", "üçæ", "üç∑", "üç∏", "üçπ", "üç∫", 
    "üçª", "ü•Ç", "ü•É", "üçΩ", "üç¥", "ü•Ñ", "üî™", "üè∫", "üåç", "üåé", "üåè", "üåê", "üó∫", "üóæ", "üèî", "‚õ∞", "üåã", "üóª", "üèï", "üèñ", "üèú", "üèù", "üèû", "üèü", "üèõ", "üèó", "üèò", 
    "üèô", "üèö", "üè†", "üè°", "üè¢", "üè£", "üè§", "üè•", "üè¶", "üè®", "üè©", "üè™", "üè´", "üè¨", "üè≠", "üèØ", "üè∞", "üíí", "üóº", "üóΩ", "‚õ™", "üïå", "üïç", "‚õ©", "üïã", "‚õ≤", "‚õ∫", "üåÅ", 
    "üåÉ", "üåÑ", "üåÖ", "üåÜ", "üåá", "üåâ", "‚ô®", "üåå", "üé†", "üé°", "üé¢", "üíà", "üé™", "üé≠", "üñº", "üé®", "üé∞", "üöÇ", "üöÉ", "üöÑ", "üöÖ", "üöÜ", "üöá", "üöà", "üöâ", "üöä", "üöù", 
    "üöû", "üöã", "üöå", "üöç", "üöé", "üöê", "üöë", "üöí", "üöì", "üöî", "üöï", "üöñ", "üöó", "üöò", "üöô", "üöö", "üöõ", "üöú", "üö≤", "üõ¥", "üõµ", "üöè", "üõ£", "üõ§", "‚õΩ", "üö®", "üö•", 
    "üö¶", "üöß", "üõë", "‚öì", "‚õµ", "üõ∂", "üö§", "üõ≥", "‚õ¥", "üõ•", "üö¢", "‚úà", "üõ©", "üõ´", "üõ¨", "üí∫", "üöÅ", "üöü", "üö†", "üö°", "üöÄ", "üõ∞", "üõé", "üö™", "üõå", "üõè", "üõã", "üöΩ", 
    "üöø", "üõÄ", "üõÄüèª", "üõÄüèº", "üõÄüèΩ", "üõÄüèæ", "üõÄüèø", "üõÅ", "‚åõ", "‚è≥", "‚åö", "‚è∞", "‚è±", "‚è≤", "üï∞", "üïõ", "üïß", "üïê", "üïú", "üïë", "üïù", "üïí", "üïû", "üïì", "üïü", "üïî", 
    "üï†", "üïï", "üï°", "üïñ", "üï¢", "üïó", "üï£", "üïò", "üï§", "üïô", "üï•", "üïö", "üï¶", "üåë", "üåí", "üåì", "üåî", "üåï", "üåñ", "üåó", "üåò", "üåô", "üåö", "üåõ", "üåú", "üå°", "‚òÄ", 
    "üåù", "üåû", "‚≠ê", "üåü", "üå†", "‚òÅ", "‚õÖ", "‚õà", "üå§", "üå•", "üå¶", "üåß", "üå®", "üå©", "üå™", "üå´", "üå¨", "üåÄ", "üåà", "üåÇ", "‚òÇ", "‚òî", "‚õ±", "‚ö°", "‚ùÑ", "‚òÉ", "‚õÑ", "‚òÑ", "üî•", 
    "üíß", "üåä", "üéÉ", "üéÑ", "üéÜ", "üéá", "‚ú®", "üéà", "üéâ", "üéä", "üéã", "üéç", "üéé", "üéè", "üéê", "üéë", "üéÄ", "üéÅ", "üéó", "üéü", "üé´", "üéñ", "üèÜ", "üèÖ", "ü•á", "ü•à", "ü•â", 
    "‚öΩ", "‚öæ", "üèÄ", "üèê", "üèà", "üèâ", "üéæ", "üé±", "üé≥", "üèè", "üèë", "üèí", "üèì", "üè∏", "ü•ä", "ü•ã", "ü•Ö", "üéØ", "‚õ≥", "‚õ∏", "üé£", "üéΩ", "üéø", "üéÆ", "üïπ", "üé≤", "‚ô†", "‚ô•", 
    "‚ô¶", "‚ô£", "üÉè", "üÄÑ", "üé¥", "üîá", "üîà", "üîâ", "üîä", "üì¢", "üì£", "üìØ", "üîî", "üîï", "üéº", "üéµ", "üé∂", "üéô", "üéö", "üéõ", "üé§", "üéß", "üìª", "üé∑", "üé∏", "üéπ", "üé∫", 
    "üéª", "ü•Å", "üì±", "üì≤", "‚òé", "üìû", "üìü", "üì†", "üîã", "üîå", "üíª", "üñ•", "üñ®", "‚å®", "üñ±", "üñ≤", "üíΩ", "üíæ", "üíø", "üìÄ", "üé•", "üéû", "üìΩ", "üé¨", "üì∫", "üì∑", "üì∏", 
    "üìπ", "üìº", "üîç", "üîé", "üî¨", "üî≠", "üì°", "üïØ", "üí°", "üî¶", "üèÆ", "üìî", "üìï", "üìñ", "üìó", "üìò", "üìô", "üìö", "üìì", "üìí", "üìÉ", "üìú", "üìÑ", "üì∞", "üóû", "üìë", "üîñ", 
    "üè∑", "üí∞", "üí¥", "üíµ", "üí∂", "üí∑", "üí∏", "üí≥", "üíπ", "üí±", "üí≤", "‚úâ", "üìß", "üì®", "üì©", "üì§", "üì•", "üì¶", "üì´", "üì™", "üì¨", "üì≠", "üìÆ", "üó≥", "‚úè", "‚úí", "üñã", "üñä", 
    "üñå", "üñç", "üìù", "üíº", "üìÅ", "üìÇ", "üóÇ", "üìÖ", "üìÜ", "üóí", "üóì", "üìá", "üìà", "üìâ", "üìä", "üìã", "üìå", "üìç", "üìé", "üñá", "üìè", "üìê", "‚úÇ", "üóÉ", "üóÑ", "üóë", "üîí", 
    "üîì", "üîè", "üîê", "üîë", "üóù", "üî®", "‚õè", "‚öí", "üõ†", "üó°", "‚öî", "üî´", "üèπ", "üõ°", "üîß", "üî©", "‚öô", "üóú", "‚öó", "‚öñ", "üîó", "‚õì", "üíâ", "üíä", "üö¨", "‚ö∞", "‚ö±", "üóø", "üõ¢", 
    "üîÆ", "üõí", "üèß", "üöÆ", "üö∞", "‚ôø", "üöπ", "üö∫", "üöª", "üöº", "üöæ", "üõÇ", "üõÉ", "üõÑ", "üõÖ", "‚ö†", "üö∏", "‚õî", "üö´", "üö≥", "üö≠", "üöØ", "üö±", "üö∑", "üìµ", "üîû", "‚ò¢", "‚ò£", 
    "‚¨Ü", "‚Üó", "‚û°", "‚Üò", "‚¨á", "‚Üô", "‚¨Ö", "‚Üñ", "‚Üï", "‚Üî", "‚Ü©", "‚Ü™", "‚§¥", "‚§µ", "üîÉ", "üîÑ", "üîô", "üîö", "üîõ", "üîú", "üîù", "üõê", "‚öõ", "üïâ", "‚ú°", "‚ò∏", "‚òØ", "‚úù", "‚ò¶", "‚ò™", "‚òÆ", 
    "üïé", "üîØ", "‚ôà", "‚ôâ", "‚ôä", "‚ôã", "‚ôå", "‚ôç", "‚ôé", "‚ôè", "‚ôê", "‚ôë", "‚ôí", "‚ôì", "‚õé", "üîÄ", "üîÅ", "üîÇ", "‚ñ∂", "‚è©", "‚è≠", "‚èØ", "‚óÄ", "‚è™", "‚èÆ", "üîº", "‚è´", "üîΩ", "‚è¨", "‚è∏", "‚èπ", 
    "‚è∫", "‚èè", "üé¶", "üîÖ", "üîÜ", "üì∂", "üì≥", "üì¥", "‚ôª", "üìõ", "‚öú", "üî∞", "üî±", "‚≠ï", "‚úÖ", "‚òë", "‚úî", "‚úñ", "‚ùå", "‚ùé", "‚ûï", "‚ûñ", "‚ûó", "‚û∞", "‚ûø", "„ÄΩ", "‚ú≥", "‚ú¥", "‚ùá", "‚Äº", "‚Åâ", 
    "‚ùì", "‚ùî", "‚ùï", "‚ùó", "„Ä∞", "¬©", "¬Æ", "‚Ñ¢", "#Ô∏è‚É£", "*Ô∏è‚É£", "0Ô∏è‚É£", "1Ô∏è‚É£", "2Ô∏è‚É£", "3Ô∏è‚É£", "4Ô∏è‚É£", "5Ô∏è‚É£", "6Ô∏è‚É£", "7Ô∏è‚É£", "8Ô∏è‚É£", "9Ô∏è‚É£", "üîü", "üíØ", "üî†", "üî°", "üî¢", "üî£", 
    "üî§", "üÖ∞", "üÜé", "üÖ±", "üÜë", "üÜí", "üÜì", "‚Ñπ", "üÜî", "‚ìÇ", "üÜï", "üÜñ", "üÖæ", "üÜó", "üÖø", "üÜò", "üÜô", "üÜö", "üàÅ", "üàÇ", "üà∑", "üà∂", "üàØ", "üâê", "üàπ", "üàö", "üà≤", 
    "üâë", "üà∏", "üà¥", "üà≥", "„äó", "„äô", "üà∫", "üàµ", "‚ñ™", "‚ñ´", "‚óª", "‚óº", "‚óΩ", "‚óæ", "‚¨õ", "‚¨ú", "üî∂", "üî∑", "üî∏", "üîπ", "üî∫", "üîª", "üí†", "üîò", "üî≤", "üî≥", "‚ö™", "‚ö´", "üî¥", 
    "üîµ", "üèÅ", "üö©", "üéå", "üè¥", "üè≥", "üá¶üá®", "üá¶üá©", "üá¶üá™", "üá¶üá´", "üá¶üá¨", "üá¶üáÆ", "üá¶üá±", "üá¶üá≤", "üá¶üá¥", "üá¶üá∂", "üá¶üá∑", "üá¶üá∏", "üá¶üáπ", "üá¶üá∫", "üá¶üáº", "üá¶üáΩ", 
    "üá¶üáø", "üáßüá¶", "üáßüáß", "üáßüá©", "üáßüá™", "üáßüá´", "üáßüá¨", "üáßüá≠", "üáßüáÆ", "üáßüáØ", "üáßüá±", "üáßüá≤", "üáßüá≥", "üáßüá¥", "üáßüá∂", "üáßüá∑", "üáßüá∏", "üáßüáπ", "üáßüáª", "üáßüáº", 
    "üáßüáæ", "üáßüáø", "üá®üá¶", "üá®üá®", "üá®üá©", "üá®üá´", "üá®üá¨", "üá®üá≠", "üá®üáÆ", "üá®üá∞", "üá®üá±", "üá®üá≤", "üá®üá≥", "üá®üá¥", "üá®üáµ", "üá®üá∑", "üá®üá∫", "üá®üáª", "üá®üáº", "üá®üáΩ", 
    "üá®üáæ", "üá®üáø", "üá©üá™", "üá©üá¨", "üá©üáØ", "üá©üá∞", "üá©üá≤", "üá©üá¥", "üá©üáø", "üá™üá¶", "üá™üá®", "üá™üá™", "üá™üá¨", "üá™üá≠", "üá™üá∑", "üá™üá∏", "üá™üáπ", "üá™üá∫", "üá´üáÆ", "üá´üáØ", 
    "üá´üá∞", "üá´üá≤", "üá´üá¥", "üá´üá∑", "üá¨üá¶", "üá¨üáß", "üá¨üá©", "üá¨üá™", "üá¨üá´", "üá¨üá¨", "üá¨üá≠", "üá¨üáÆ", "üá¨üá±", "üá¨üá≤", "üá¨üá≥", "üá¨üáµ", "üá¨üá∂", "üá¨üá∑", "üá¨üá∏", "üá¨üáπ", 
    "üá¨üá∫", "üá¨üáº", "üá¨üáæ", "üá≠üá∞", "üá≠üá≤", "üá≠üá≥", "üá≠üá∑", "üá≠üáπ", "üá≠üá∫", "üáÆüá®", "üáÆüá©", "üáÆüá™", "üáÆüá±", "üáÆüá≤", "üáÆüá≥", "üáÆüá¥", "üáÆüá∂", "üáÆüá∑", "üáÆüá∏", "üáÆüáπ", 
    "üáØüá™", "üáØüá≤", "üáØüá¥", "üáØüáµ", "üá∞üá™", "üá∞üá¨", "üá∞üá≠", "üá∞üáÆ", "üá∞üá≤", "üá∞üá≥", "üá∞üáµ", "üá∞üá∑", "üá∞üáº", "üá∞üáæ", "üá∞üáø", "üá±üá¶", "üá±üáß", "üá±üá®", "üá±üáÆ", "üá±üá∞", 
    "üá±üá∑", "üá±üá∏", "üá±üáπ", "üá±üá∫", "üá±üáª", "üá±üáæ", "üá≤üá¶", "üá≤üá®", "üá≤üá©", "üá≤üá™", "üá≤üá´", "üá≤üá¨", "üá≤üá≠", "üá≤üá∞", "üá≤üá±", "üá≤üá≤", "üá≤üá≥", "üá≤üá¥", "üá≤üáµ", "üá≤üá∂", 
    "üá≤üá∑", "üá≤üá∏", "üá≤üáπ", "üá≤üá∫", "üá≤üáª", "üá≤üáº", "üá≤üáΩ", "üá≤üáæ", "üá≤üáø", "üá≥üá¶", "üá≥üá®", "üá≥üá™", "üá≥üá´", "üá≥üá¨", "üá≥üáÆ", "üá≥üá±", "üá≥üá¥", "üá≥üáµ", "üá≥üá∑", "üá≥üá∫", 
    "üá≥üáø", "üá¥üá≤", "üáµüá¶", "üáµüá™", "üáµüá´", "üáµüá¨", "üáµüá≠", "üáµüá∞", "üáµüá±", "üáµüá≤", "üáµüá≥", "üáµüá∑", "üáµüá∏", "üáµüáπ", "üáµüáº", "üáµüáæ", "üá∂üá¶", "üá∑üá™", "üá∑üá¥", "üá∑üá∏", 
    "üá∑üá∫", "üá∑üáº", "üá∏üá¶", "üá∏üáß", "üá∏üá®", "üá∏üá©", "üá∏üá™", "üá∏üá¨", "üá∏üá≠", "üá∏üáÆ", "üá∏üáØ", "üá∏üá∞", "üá∏üá±", "üá∏üá≤", "üá∏üá≥", "üá∏üá¥", "üá∏üá∑", "üá∏üá∏", "üá∏üáπ", "üá∏üáª", 
    "üá∏üáΩ", "üá∏üáæ", "üá∏üáø", "üáπüá¶", "üáπüá®", "üáπüá©", "üáπüá´", "üáπüá¨", "üáπüá≠", "üáπüáØ", "üáπüá∞", "üáπüá±", "üáπüá≤", "üáπüá≥", "üáπüá¥", "üáπüá∑", "üáπüáπ", "üáπüáª", "üáπüáº", "üáπüáø", 
    "üá∫üá¶", "üá∫üá¨", "üá∫üá≤", "üá∫üá∏", "üá∫üáæ", "üá∫üáø", "üáªüá¶", "üáªüá®", "üáªüá™", "üáªüá¨", "üáªüáÆ", "üáªüá≥", "üáªüá∫", "üáºüá´", "üáºüá∏", "üáΩüá∞", "üáæüá™", "üáæüáπ", "üáøüá¶", "üáøüá≤", 
    "üáøüáº", "ü™®", "üß†", "‚ôæÔ∏è", "‚ôæ", "üßÆ", "üõ∏",
    "\uFE00", "\uFE0E", "\uFE0F"];


// const SERVER = "http://localhost:80"
const SERVER = "https://server.speedydelete.com";

const INVALID = `\0\t\n\v\f\r0123456789"\xa0`;

let modeElt = document.getElementById("mode");
let individualDiv = document.getElementById("individual-tab");
let chainDiv = document.getElementById("chain-tab");
let trophyDiv = document.getElementById("trophy-tab");

let beatsElt = document.getElementById("beats");
let beatenElt = document.getElementById("beaten");

let chainElt = document.getElementById("chain");

let trophyElt = document.getElementById("trophy");

let statusDiv = document.getElementById("status");
let timeElt = document.getElementById("time");
let statusCodeElt = document.getElementById("status-code");
let reasonElt = document.getElementById("reason");

let queryElt = document.getElementById("query");
let ttbElt = document.getElementById("ttb");
let outCountElt = document.getElementById("out-count");
let outQueryElt = document.getElementById("out-query");
let resultsElt = document.getElementById("results");


function switchTab() {
    mode = modeElt.value;
    individualDiv.style.display = "none";
    chainDiv.style.display = "none";
    trophyDiv.style.display = "none";
    if (mode == "individual") {
        individualDiv.style.display = "block";
    } else if (mode == "chain") {
        chainDiv.style.display = "block";
    } else if (mode == "trophy") {
        trophyDiv.style.display = "block";
    }
}

window.addEventListener("load", switchTab);


function validate(thing, emoji=false) {
    thing = thing.toLowerCase().trim();
    if (thing.length > 280) {
        return false;
    }
    for (const char of thing) {
        if (INVALID.includes(char)) {
            return false;
        } else if (EMOJI.includes(char)) {
            if (emoji) {
                thing = thing.replaceAll(char, "");
            } else {
                return false;
            }
        }
    }
    return thing.replaceAll('\u200b', '').replaceAll('œÉ', '').replaceAll("‚ôæÔ∏è", "").replaceAll(" Ô∏è", "");
}


async function sendReq(path, data) {
    const resp = await fetch(SERVER + path, data)
    statusDiv.style.color = (resp.status < 400) ? "green" : "red";
    timeElt.textContent = (new Date()).toLocaleTimeString();
    statusCodeElt.textContent = resp.status;
    reasonElt.textContent = resp.statusText;
    if (resp.status != 204 && resp.status < 400) {
        let text = await resp.text();
        return text.split('\n');
    } else if (resp.status == 400) {
        alert("Invalid input");
    } else if (resp.status == 418) {
        alert("global rate limit is enabled due to too much data, try again in a few minutes");
    }
}

async function addCombination() {
    let data;
    if (mode == "individual") {
        data = [beatsElt.value, beatenElt.value];
    } else if (mode == "chain") {
        data = chainElt.value;
        if (data.includes("üòµ")) {
            data = data.split("üòµ")[1];
        }
        data = data.split("ü§ú");
    } else if (mode == "trophy") {
        data = trophyElt.value;
        data = data.split('\n');
        let trophies = [];
        let withCount = 0;
        for (let trophy of data) {
            if (trophy.includes("üèÜ")) {
                continue;
            }
            if (trophy.length < 1) {
                continue;
            }
            trophy = validate(trophy, emoji=true).split(" with ");
            if (trophy.length > 2) {
                withCount += 1;
                continue;
            } else if (trophy.length == 1) {
                continue;
            }
            trophy = [validate(trophy[1]), validate(trophy[0])];
            if (trophy.some((x) => !x)) {
                alert('invalid input');
                return;
            }
            trophies.push(trophy.join("\n"));
        }
        if (withCount > 0) {
            alert(`sorry, ${withCount} items with \" with \" in them were skipped`);
        }
        await sendReq("/add/", {
            method: "post",
            body: trophies.join("\n\n"),
        });
    }
    if ("individualchain".includes(mode)) {
        let validated = [];
        data.forEach((x) => validated.push(validate(x)));
        if (validated.some((x) => !x)) {
            alert('invalid input');
            return;
        }
        await sendReq("/add/", {
            method: "post",
            body: validated.join("\n"),
        });
    }
    alert("Data added");
}

async function getBeats() {
    let data = validate(queryElt.value);
    if (!data) {
        alert('invalid input');
        return;
    }
    text = await sendReq("/get/" + encodeURIComponent(data), {method: "get"});
    if (text.length == 1 && text[0] == "") {
        text = [];
    }
    ttbElt.style.display = "block";
    outCountElt.innerText = text.length;
    outQueryElt.innerText = data;
    resultsElt.innerHTML = "";
    text.sort((a, b) => a.length - b.length);
    for (const thing of text) {
        let elt = document.createElement("li");
        elt.innerText = thing;
        resultsElt.appendChild(elt);
    }
}

        </script>
    </body>
</html>
